{"version":3,"file":"TabSelect.js","sourceRoot":"","sources":["../src/TabSelect.ts"],"names":[],"mappings":"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","sourcesContent":["import { h2, p, Register, div, img, h4, ListenerDefinition } from 'io-gui';\nimport { TabBase, TabBaseProps } from './TabBase.js';\nimport { contentStore } from './services/ContentStore.js';\n\nconst GESTURE_THRESHOLD = 20;\n\n@Register\nexport class TabSelect extends TabBase {\n    static get Style() {\n        return /* css */`\n            :host {\n                text-align: justify;\n            }\n            :host .cover-image {\n                pointer-events: none;\n                float: right;\n                margin: 4.2em 0 0.5em 1em;\n            }\n        `;\n    }\n\n    declare startX: number;\n    declare startY: number;\n\n    static get Listeners() {\n        return {\n            'pointerdown': 'onPointerdown',\n            'touchstart': ['preventDefault', {passive: false}] as ListenerDefinition,\n            'touchmove': ['preventDefault', {passive: false}] as ListenerDefinition,\n            'wheel': 'onScroll',\n        };\n    }\n\n    preventDefault(event: Event) {\n        event.preventDefault();\n    }\n    onPointerdown(event: PointerEvent) {\n        this.setPointerCapture(event.pointerId);\n        this.addEventListener('pointerup', this.onPointerup);\n        this.addEventListener('pointercancel', this.onPointerup);\n        this.startX = event.clientX;\n        this.startY = event.clientY;\n    }\n    onPointerup(event: PointerEvent) {\n        this.releasePointerCapture(event.pointerId);\n        this.removeEventListener('pointerup', this.onPointerup);\n        this.removeEventListener('pointercancel', this.onPointerup);\n        const dx = event.clientX - this.startX;\n        const dy = event.clientY - this.startY;\n        const distance = Math.sqrt(dx * dx + dy * dy);\n\n        let gesture = 'tap';\n        if (distance > GESTURE_THRESHOLD) {\n            if (Math.abs(dx) > Math.abs(dy)) {\n                gesture = dx > 0 ? 'east' : 'west';\n            } else {\n                gesture = dy > 0 ? 'south' : 'north';\n            }\n        }\n\n        switch (gesture) {\n        case 'tap': this.controller.sendSelectEvent('tap'); break;\n        case 'north': this.controller.sendSelectEvent('north'); break;\n        case 'south': this.controller.sendSelectEvent('south'); break;\n        case 'east': this.controller.sendSelectEvent('east'); break;\n        case 'west': this.controller.sendSelectEvent('west'); break;\n        }\n    }\n\n    changed() {\n        let description = 'No description available';\n        const selected = this.simulatorState?.selectedItem;\n        if (selected?.description) {\n            description = selected.description\n                .split(/\\n+/) // Split on any number of newlines\n                .filter((line: string) => line.trim().length > 0) // Remove empty lines\n                .map((line: string) => `<p>${line.trim()}</p>`) // Create paragraph for each line\n                .join('');\n        }\n\n        // Resolve cover base from content store (built-in StreamingAssets path or external)\n        const shared: any = (this.controller as any).simulatorState || {};\n        const contentKey = (shared as any).contentKey || (shared as any).contentIndexUrl;\n        const contentRec = contentStore.getContent(contentKey);\n        const assetsBase = (shared as any).assetsBaseUrl || '../SpaceCraft/StreamingAssets/Content/';\n\n        this.render([\n            h2('TAP or SWIPE to select items'),\n            selected ? div([\n                img({src: `${assetsBase}collections/scifi/items/${selected.id}/cover.jpg`, alt: `Cover for ${selected.title}`, class: 'cover-image'}),\n                h4(selected.title || 'Untitled'),\n                div({class: 'description', innerHTML: description}),\n            ]) : p('No item selected'),\n        ]);\n    }\n}\n\nexport const tabSelect = function(arg0: TabBaseProps) {\n    return TabSelect.vConstructor(arg0);\n};"]}